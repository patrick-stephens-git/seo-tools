# coding: utf-8
import sys
import re

# allows choice of input file from command line:
# $ python keyword-normalizer.py input_file.txt
command_file = sys.argv[1]

# regex to remove all company suffixes from keyword for normalization.
# company suffixes from Goku
def normalizer(input_list):
    for line in input_list:
        yield(re.sub(r"(\s& co\.\s?$|\s& co\.kg\s?$|\s&co\s?$|\s&co\.\s?$|\s-me\s?$|\s\.be\s?$|\s\.nl\s?$|\s\.se\s?$|\s\(gmbh & co kg\)\s?$|\s\(haftungsbeschränkt\)\s?$|\s\(有\)\s?$|\s\(株\)\s?$|\s\(유\)\s?$|\s\(주\)\s?$|\s\\d元\s?$|\sa \. Ş \.\s?$|\sa r\.l\.\s?$|\sa rl\s?$|\sa\. s\.\s?$|\sa\.e\.\s?$|\sa\.s\.\s?$|\sa\.Ş\s?$|\sa\.Ş\.\s?$|\sa/s\s?$|\sab\s?$|\sabt\.\s?$|\sadm\. serv\. ltda\s?$|\sae\s?$|\sag\s?$|\sag & co\. kg\s?$|\sag & co\.kg\s?$|\sag&co\. kg\s?$|\sag&co\.kg\s?$|\sakc\. spol\.\s?$|\saktiebolag\s?$|\saktiebolaget\s?$|\saps\s?$|\sarl\s?$|\sas\s?$|\sasa\s?$|\say\s?$|\saŞ\s?$|\sb\.v\.\s?$|\sb\.v\. & co\. kg\s?$|\sb\.v\.&co\. kg\s?$|\sb\.v\.&co\.kg\s?$|\sb\.v\.b\.a\s?$|\sba\s?$|\sbelgie\s?$|\sbelgique\s?$|\sbelgium\s?$|\sbelgië\s?$|\sbereich\s?$|\sbt\s?$|\sbv\s?$|\sbvba\s?$|\sc / o\s?$|\sc/o\s?$|\scnc\s?$|\sco\s?$|\sco kg\s?$|\sco kg c/o\s?$|\sco\.\s?$|\sco\., ltd\s?$|\sco\.,ltd\s?$|\scokg c/o\s?$|\scokgc/o\s?$|\scomercio importação e exportação ltda\s?$|\scomércio importação e exportação ltda\s?$|\scong ty\s?$|\scong ty co phan\s?$|\scong ty cp\s?$|\scong ty tnhh\s?$|\scong ty tnhh mot thanh vien\s?$|\scong ty tnhh mtv\s?$|\scong ty trach nhiem huu han\s?$|\scoop\s?$|\scoop\.\s?$|\scooperativa sociale\s?$|\scorp\s?$|\scorp\.\s?$|\scorporation\s?$|\scty cp\s?$|\scty tnhh\s?$|\scty tnhh tm\s?$|\scông ty\s?$|\scông ty cp\s?$|\scông ty cổ phần\s?$|\scông ty tnhh\s?$|\scông ty tnhh mtv\s?$|\scông ty tnhh một thành viên\s?$|\scông ty trách nhiệm hữu hạn\s?$|\sdeutschland\s?$|\sditta indiv\s?$|\sditta indiv\.\s?$|\sditta individuale\s?$|\se\. kfr\.\s?$|\se\.e\.\s?$|\se\.g\.\s?$|\se\.i\.r\.l\s?$|\se\.i\.r\.l\.\s?$|\se\.k\.\s?$|\se\.p\.p\.\s?$|\se\.t\.t\s?$|\se\.t\.t\.\s?$|\se\.u\.\s?$|\se\.v\.\s?$|\see\s?$|\seg\s?$|\seirl\s?$|\sepp\s?$|\sett\s?$|\seurl\s?$|\sfilia\s?$|\sgbc\s?$|\sgbr\s?$|\sgermany\s?$|\sges\.\s?$|\sgesmbh\s?$|\sggmbh\s?$|\sgmbh\s?$|\sgmbh & co\. kg\s?$|\sgmbh & co\. ohg\s?$|\sgmbh&co\. kg\s?$|\sgmbh&co\.kg\s?$|\sgmbh\.\s?$|\sgroep\s?$|\sgroup\s?$|\shaftungsbeschränkt\s?$|\shandelsbolag\s?$|\shandelsgesellschaft\s?$|\sherr\s?$|\shf\s?$|\shiz tem\.\s?$|\shiz\.\s?$|\shiz\.a\.s\.\s?$|\shiz\.a\.Ş\.\s?$|\sholding\s?$|\si sthlm\s?$|\si stockholm\s?$|\si sverige\s?$|\si\.o\.\s?$|\simportante\s?$|\sin scandinavia\s?$|\sinc\s?$|\sinc\.\s?$|\sincorporated\s?$|\sind\s?$|\sind com\s?$|\sind com ltda\s?$|\sind e com ltda\s?$|\sind e com\.\s?$|\sind ltda me\s?$|\sind\.\s?$|\sind\. com\.\s?$|\sind\. com\.ltda\s?$|\sind\. confeccoes ltda\s?$|\sind\. e com\.\s?$|\sind\. e com\. export\.\s?$|\sind\. e com\. ltda\s?$|\sind\.e com\.ltda\s?$|\sinh\s?$|\sinh\.\s?$|\sinhaber\s?$|\sint\s?$|\sint\.\s?$|\sinvestment co\.\s?$|\sitプロフェッショナルサービス統括部\s?$|\sk\. s\.\s?$|\sk\.k\.\s?$|\sk\.s\.\s?$|\skar\s?$|\skb\s?$|\skft\s?$|\skft\.\s?$|\skg\s?$|\skgaa\s?$|\skom\. spol\.\s?$|\skommanditbolag\s?$|\sks\s?$|\sky\s?$|\sl\.l\.c\s?$|\sl\.l\.c\.\s?$|\sl\.l\.p\s?$|\sl\.l\.p\.\s?$|\sl\.p\s?$|\sl\.p\.\s?$|\slda\s?$|\slda\.\s?$|\slimited\s?$|\sllc\s?$|\sllp\s?$|\slp\s?$|\slss\s?$|\sltd\s?$|\sltd sti\s?$|\sltd Şti\s?$|\sltd\.\s?$|\sltd\. & co\.kg\.\s?$|\sltd\. sti\.\s?$|\sltd\. Şti\s?$|\sltd\.&co\.kg\.\s?$|\sltda\s?$|\sltda - me\s?$|\sltda me\s?$|\sltda-epp\s?$|\sltda-me\s?$|\sltda\.\s?$|\sltda\.-me\s?$|\sltda\.epp\s?$|\sltda\.me\s?$|\sm\.\s?$|\sm\.b\.h\.\s?$|\sm\.st\.\s?$|\smadame\s?$|\smademoiselle\s?$|\smak\.\s?$|\smbh\s?$|\smbh & co\.kg\s?$|\smbh& co\.kg\s?$|\smbh&co\.kg\s?$|\sme\s?$|\smle\s?$|\smlle\s?$|\smme\s?$|\smonsieur\s?$|\sn\.v\.\s?$|\sndl\s?$|\sndl\.\s?$|\snederland\s?$|\snetherlands\s?$|\sniederlassung\s?$|\snl\s?$|\snr\s?$|\snv\s?$|\so\.e\.\s?$|\soddział\s?$|\soddziaŁ w polsce\s?$|\soe\s?$|\soesterreich\s?$|\sog\s?$|\sohg\s?$|\soy\s?$|\soyj\s?$|\sp\.a\.\s?$|\sp\.h\.u\.\s?$|\sp\.s\.k\.\s?$|\spaz\s?$|\spaz\. san\. ltd Ştİ\s?$|\spaz\. tİc\. ve san\. a\.Ş\.\s?$|\spaz\.aŞ\.\s?$|\spaz\.ltd\.Ştİ\.\s?$|\spaz\.san\.ltd\.Ştİ\s?$|\sphu\s?$|\splc\s?$|\splv\s?$|\spme\s?$|\spmi\s?$|\spoland\s?$|\spolska holding\s?$|\spphtu\s?$|\spt\s?$|\spt\.\s?$|\sr\.l\s?$|\sr\.l\.\s?$|\srcv\s?$|\srl\s?$|\sry\s?$|\ss a\s?$|\ss de r\.l de c\.v\s?$|\ss de rl\s?$|\ss de rl de cv\s?$|\ss-ka\s?$|\ss\. de r\.l\s?$|\ss\. de r\.l\.\s?$|\ss\. de r\.l\. de c\.v\.\s?$|\ss\. de rl de cv\s?$|\ss\. r\. o\.\s?$|\ss\.a\s?$|\ss\.a de c\.v\s?$|\ss\.a\.\s?$|\ss\.a\. de c\.v\.\s?$|\ss\.a\. de r\.l\.\s?$|\ss\.a\. de r\.l\. de c\.v\s?$|\ss\.a\.r\.l\.\s?$|\ss\.a\.s\s?$|\ss\.a\.s\.\s?$|\ss\.a\.u\s?$|\ss\.a\.u\.\s?$|\ss\.c\s?$|\ss\.c\.\s?$|\ss\.c\.a\s?$|\ss\.c\.a\.\s?$|\ss\.c\.p\s?$|\ss\.c\.p\.\s?$|\ss\.c\.r\.l\.\s?$|\ss\.ca\.r\.l\s?$|\ss\.cons\.r\.l\s?$|\ss\.coop\.\s?$|\ss\.l\s?$|\ss\.l\.\s?$|\ss\.l\.n\.e\s?$|\ss\.l\.n\.e\.\s?$|\ss\.l\.u\s?$|\ss\.l\.u\.\s?$|\ss\.n\.c\s?$|\ss\.n\.c\.\s?$|\ss\.p\.a\s?$|\ss\.p\.a\.\s?$|\ss\.r\.l\s?$|\ss\.r\.l de c\.v\.\s?$|\ss\.r\.l\.\s?$|\ss\.r\.o\.\s?$|\ss\.rl\.\s?$|\ss/a\s?$|\ss/c\s?$|\ss/c ltda\s?$|\ssa\s?$|\ssa de cv\s?$|\ssa de rl\s?$|\ssa de rl cv\s?$|\ssan ltd Ştİ\s?$|\ssan tic\s?$|\ssan tic ltd sti\s?$|\ssan tic\.\s?$|\ssan ve tic\s?$|\ssan\.\s?$|\ssan\. ltd\.\s?$|\ssan\. tic\.\s?$|\ssan\. tic\. ltd\. sti\.\s?$|\ssan\. tİc\. ltd\. Ştİ\.\s?$|\ssan\. ve tic\.\s?$|\ssan\.ltd\.Ştİ\.\s?$|\ssan\.tic\.ltd\.sti\s?$|\ssantic\s?$|\ssanve\s?$|\ssanvetic\s?$|\ssarl\s?$|\ssas\s?$|\ssasu\s?$|\ssau\s?$|\ssc\s?$|\ssc ltda\s?$|\ssc\.\s?$|\ssca\s?$|\sscp\s?$|\sscrl\s?$|\sse\s?$|\sserv\. adm\. ltda\s?$|\ssicaf\s?$|\ssicav\s?$|\ssiehe beschreibung\s?$|\sslne\s?$|\sslu\s?$|\ssnc\s?$|\ssoc coop\s?$|\ssoc\.\s?$|\ssoc\.coop\.\s?$|\ssocietà cooperativa\s?$|\ssocietà cooperativa sociale\s?$|\ssp zo\.o\.\s?$|\ssp\.\s?$|\ssp\. j\.\s?$|\ssp\. z o\. o\.\s?$|\ssp\. z o\.o\.\s?$|\ssp\. z o\.o\. sp\. k\s?$|\ssp\. z o\.o\. sp\. k\.\s?$|\ssp\. z o\.o\./ o\.\s?$|\ssp\. zo\.o\.\s?$|\ssp\.j\.\s?$|\ssp\.k\.\s?$|\ssp\.p\.\s?$|\ssp\.z o\.o\.\s?$|\ssp\.z\.o\.o\s?$|\ssp\.zo\.o\. s\.k\.\s?$|\sspa\s?$|\sspol\. r\. o\.\s?$|\sspol\. s r\. o\.\s?$|\sspÓŁka akcyjna\s?$|\sspÓŁka z o\.o\.\s?$|\sspółka\s?$|\sspółka jawna\s?$|\sspółka z o\.o\.\s?$|\ssrl\s?$|\ssrl de cv\s?$|\ssrl\.\s?$|\ssro\s?$|\sstandort\s?$|\sstg\.\s?$|\ssvces\s?$|\ssàrl\s?$|\ss＆p事業部\s?$|\st\.t\s?$|\st\.t\.\s?$|\stbk\s?$|\stbk\.\s?$|\stem\.\s?$|\stic\s?$|\stic\.\s?$|\strabajo temporal\s?$|\stt\s?$|\su\.a\.\s?$|\sug\s?$|\sv\. o\. s\.\s?$|\sv\.o\.f\.\s?$|\sv\.o\.s\.\s?$|\svetic\s?$|\svof\s?$|\svos\s?$|\sworldwide\s?$|\sz o\.o\.\s?$|\szobacz wizytówkę\s?$|\szrt\s?$|\szrt\.\s?$|\szzp\s?$|\s®\s?$|\sÖsterreich\s?$|\s㈜\s?$|\s店\s?$|\s주\s?$|\sบ\.\s?$|\sΕ\.Π\.Ε\.\s?$|\sİnş\s?$|\sİnş tic san\s?$|\sİnş\.\s?$|\sİnŞ\.tİc\.san\.\s?$|\sİth\. İhr\.\s?$|\sİth İhr\s?$|\sŞti\.\s?$|\sŞtİ\s?$|\sŞtİ\.\s?$|\sАБ\s?$|\sАК\s?$|\sАО\s?$|\sАП\s?$|\sАФ\s?$|\sГК\s?$|\sГУ\s?$|\sИП\s?$|\sКА\s?$|\sКБ\s?$|\sСК\s?$|\sТД\s?$|\sТК\s?$|\sХК\s?$|\s中心\s?$|\s公司\s?$|\s周辺\s?$|\s商店\s?$|\s基地\s?$|\s工場\s?$|\s招聘\s?$|\s控股\s?$|\s支店\s?$|\s支社\s?$|\s本店\s?$|\s本社\s?$|\s派遣\s?$|\s职介\s?$|\s集团\s?$|\s面议\s?$|\s회사\s?$|\s有限\.\.\s?$|\sΕΠΕ\s?$|\sАКБ\s?$|\sАРК\s?$|\sЗАО\s?$|\sНИИ\s?$|\sНКО\s?$|\sНПП\s?$|\sНПЦ\s?$|\sОАО\s?$|\sООО\s?$|\sТПК\s?$|\sエリア\s?$|\s事业群\s?$|\s事业部\s?$|\s事業部\s?$|\s営業所\s?$|\s営業部\s?$|\s東日本\s?$|\s西日本\s?$|\s连锁店\s?$|\s連合会\s?$|\s非中介\s?$|\s駅前店\s?$|\s엘엘씨\s?$|\sบจก\.\s?$|\sบมจ\.\s?$|\sหจก\.\s?$|\sหสม\.\s?$|\sオフィス\s?$|\s中介咨询\s?$|\s人才咨询\s?$|\s合作集团\s?$|\s合同会社\s?$|\s合同募集\s?$|\s合资公司\s?$|\s国际学校\s?$|\s培训中心\s?$|\s大宮支店\s?$|\s広島支社\s?$|\s开业直招\s?$|\s控股公司\s?$|\s新宿支社\s?$|\s有限会社\s?$|\s有限公司\s?$|\s服务中心\s?$|\s服务平台\s?$|\s東京本社\s?$|\s株式会社\s?$|\s横浜支店\s?$|\s独资企业\s?$|\s猎头岗位\s?$|\s福山支店\s?$|\s科技集团\s?$|\s筹备中心\s?$|\s管理中心\s?$|\s管理集团\s?$|\s紹介部門\s?$|\s美食广场\s?$|\s职业学院\s?$|\s関東支社\s?$|\s関西支社\s?$|\s유한회사\s?$|\s주식회사\s?$|\sจำกัด\s?$|\sมหาชน\s?$|\sの求人詳細\s?$|\s一般派遣業\s?$|\s丸の内本社\s?$|\s人才推荐部\s?$|\s民センター\s?$|\s福祉事業部\s?$|\sบริษัท\s?$|\s个人用品商店\s?$|\s大阪オフィス\s?$|\s岡山西営業所\s?$|\s有限公司招聘\s?$|\s有限责任公司\s?$|\s登録センター\s?$|\s经济有限公司\s?$|\s股份有限公司\s?$|\sホームページへ\s?$|\s事務派遣事業部\s?$|\sメディカル事業部\s?$|\s看護師紹介事業部\s?$|\sエントリーセンター\s?$|\sメディカル事業本部\s?$|\sリクルートセンター\s?$|\sロジスティクス事業部\s?$|\s本次招聘活动举办单位\s?$|\s本次招聘活动举办单位:\s?$|\sกลุ่มบริษัท\s?$|\sエントリーセンター横浜\s?$|\sエントリーセンター渋谷\s?$|\sジョブシェアリング営業部\s?$|\sテレマーケティング事業部\s?$|\sＩＴソリューションブロック\s?$|\sห้างหุ้นส่วนจำกัด\s?$|\sห้างหุ้นส่วนสามัญ\s?$|,|\.|:.*|\\|/|-| -.*|- .*|\(.*\)|\[.*\]|\{.*\}|\|.*)",' ',line,count=0,flags=re.I))

# removes excess whitespace from keyword
def remove_spaces(input_list):
    for line in input_list:
        yield(re.sub(' +',' ',line,count=0,flags=re.I))

# writes results to .txt file
def write_file(generator,filename):
    with open('normalized-{0}'.format(filename),'w') as export_file:
        for line in generator:
            if re.match(r'^\s*$',line): # removes any blank lines from file
                pass
            else:
                export_file.write(str(line) + '\n')

with open(command_file,'r') as input_file:
    input_list = [line.strip('\n') for line in input_file]

normalized_list = normalizer(input_list)
clean_list = remove_spaces(normalized_list)
normalized_2 = normalizer(clean_list) # running it through twice to remove any suffixes not captured first time due to spacing/placement
clean_2 = remove_spaces(normalized_2)
finish_it = [line.strip() for line in clean_2] # strips excess whitespace from beginning and end of keyword
write_file(finish_it,command_file)